<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kiosko</title>
    
    <!--Material CDN-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Sharp" rel="stylesheet">
    <!--Styles-->
    <link rel="icon" href="{{ url_for('static', filename='img/logo.png') }}" type="image/png">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/pagination.css') }}">
</head>
<body>

    <div class="container">
        <!--====================BEGIN ASIDE ====================-->
        <aside>
            <div class="top">
                <div class="logo">
                    <img src="{{ url_for('static', filename='img/logo.png') }}">
                    <h2>Kios<span class="danger">Ko</span></h2>
                </div>
                <div class="close" id="close-btn">
                    <span class="material-icons-sharp">close</span>
                </div>
            </div>
            <div class="sidebar">
                <a href="#" class="active">
                    <span class="material-icons-sharp">grid_view</span>
                    <h3>Dashboard</h3>
                </a>
                <!-- <a href="#">
                    <span class="material-icons-sharp">person_outline</span>
                    <h3>Customers</h3>
                </a> -->
                <a href="#">
                    <span class="material-icons-sharp">receipt_long</span>
                    <h3>Orders</h3>
                </a>
              <!--   <a href="#">
                    <span class="material-icons-sharp">insights</span>
                    <h3>Analytics</h3>
                    <span class="message-count">Beta</span>
                </a> -->
                <!-- <a href="#">
                    <span class="material-icons-sharp">mail_outline</span>
                    <h3>Messages</h3>
                    <span class="message-count">26</span>
                </a> -->
                <a href="#">
                    <span class="material-icons-sharp">category</span>
                    <h3>Categories</h3>
                </a>
                <a href="#">
                    <span class="material-icons-sharp">inventory</span>
                    <h3>Products</h3>
                </a>
                <!-- <a href="#">
                    <span class="material-icons-sharp">report_gmailerrorred</span>
                    <h3>Reports</h3>
                </a> -->
                <a href="#">
                    <span class="material-icons-sharp">settings</span>
                    <h3>Settings</h3>
                </a>
                <a href="#">
                    <span class="material-icons-sharp">add</span>
                    <h3>Add Product</h3>
                </a>
                <a href="{{ url_for('logout') }}">
                    <span class="material-icons-sharp">logout</span>
                    <h3>Logout</h3>
                </a>
            </div>
        </aside>
         <!--====================END ASIDE ====================-->
        <main>
            <h1>Dashboard</h1>
            <div class="date">
                <input type="date">
            </div>
            <div class="insights">
                <div class="sales">
                    <span class="material-icons-sharp">analytics</span>
                    <div class="middle">
                        <div class="left">
                            <h3>Total Sales</h3>
                            <h1>$25,024</h1>
                        </div>
                        <div class="progress">
                            <svg>
                                <circle cx="38" cy="38" r="36"></circle>
                            </svg>
                            <div class="number">
                                <p>81%</p>
                            </div>
                        </div>
                    </div>
                    <small class="text-muted">Last 24 Hours</small>
                </div>
                <!--====================END SALES ====================-->
                <div class="expenses">
                    <span class="material-icons-sharp">bar_chart</span>
                    <div class="middle">
                        <div class="left">
                            <h3>Total Expenses</h3>
                            <h1>$14,160</h1>
                        </div>
                        <div class="progress">
                            <svg>
                                <circle cx="38" cy="38" r="36"></circle>
                            </svg>
                            <div class="number">
                                <p>62%</p>
                            </div>
                        </div>
                    </div>
                    <small class="text-muted">Last 24 Hours</small>
                </div>
                <!--====================END EXPENSES ====================-->
                <div class="income">
                    <span class="material-icons-sharp">stacked_line_chart</span>
                    <div class="middle">
                        <div class="left">
                            <h3>Total Income</h3>
                            <h1>$10,084</h1>
                        </div>
                        <div class="progress">
                            <svg>
                                <circle cx="38" cy="38" r="36"></circle>
                            </svg>
                            <div class="number">
                                <p>44%</p>
                            </div>
                        </div>
                    </div>
                    <small class="text-muted">Last 24 Hours</small>
                </div>
                <!--====================END INCOME ====================-->
            </div>
             <!--==================== END INSIGHTS ====================-->
             <!--=== BEGIN ORDERS ====-->
             <div class="recent-orders">
                <h2>Recent Orders</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Table</th>
                            <th>NameFood</th>
                            <th>Quantity</th>
                            <th>Description</th>
                            <th>Date</th>
                            <th>Total</th>
                            <th>Served</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody id="order-table-body">
                    </tbody>
                </table>
                <div class="pagination">
                    <ul id="pagination-list">
                        <li class="page-item" id="page-previous">
                            <a href="#" class="page-link">Previous</a>
                        </li>
                    </ul>
                </div>
            </div>
            
        </main>
         <!--==================== END MAIN ====================-->
         <div class="right">
            <div class="top">
                <button id="menu-btn">
                    <span class="material-icons-sharp">menu</span>
                </button>
                <div class="theme-toggler">
                    <span class="material-icons-sharp active">light_mode</span>
                    <span class="material-icons-sharp">dark_mode</span>
                </div>
                <div class="profile">
                    <div class="info">
                        <p>Hey, <b>{{current_user.fullname}}</b></p>
                        <small class="text-muted">Admin</small>
                    </div>
                    <div class="profile-photo">
                        <img src="{{ url_for('static', filename='img/profile.png') }}">
                    </div>
                </div>
            </div>
             <!--====== END TOP ======-->
            <div class="recent-updates">
                <h2>Recent Updates</h2>
                <div class="updates">
                    <div class="update">
                        <div class="profile-photo">
                            <img src="{{ url_for('static', filename='img/profile.png') }}">
                        </div>
                        <div class="message">
                            <p><b>Myke Tyson</b> received his order of Night lion tech GPS drone</p>
                            <small class="text-muted">2 Minutes Ago</small>
                        </div>
                    </div>
                    <div class="update">
                        <div class="profile-photo">
                            <img src="{{ url_for('static', filename='img/profile.png') }}">
                        </div>
                        <div class="message">
                            <p><b>Myke Tyson</b> received his order of Night lion tech GPS drone</p>
                            <small class="text-muted">2 Minutes Ago</small>
                        </div>
                    </div>
                    <div class="update">
                        <div class="profile-photo">
                            <img src="{{ url_for('static', filename='img/profile.png') }}">
                        </div>
                        <div class="message">
                            <p><b>Myke Tyson</b> received his order of Night lion tech GPS drone</p>
                            <small class="text-muted">2 Minutes Ago</small>
                        </div>
                    </div>
                </div>
            </div>
            <!--==================== END RECENT UPDATES ====================-->
            <div class="sales-analytics">
                <h2>Sales Analytics</h2>
                <div class="item online">
                    <div class="icon">
                        <span class="material-icons-sharp">shopping_cart</span>
                    </div>
                    <div class="right">
                        <div class="info">
                            <h3>ONLINE ORDERS</h3>
                            <small class="text-muted">Last 24 Hours</small>
                        </div>
                        <h5 class="success">+39%</h5>
                        <h3>3849</h3>
                    </div>
                </div>
                
                <div class="item offline">
                    <div class="icon">
                        <span class="material-icons-sharp">local_mall</span>
                    </div>
                    <div class="right">
                        <div class="info">
                            <h3>OFFLINE ORDERS</h3>
                            <small class="text-muted">Last 24 Hours</small>
                        </div>
                        <h5 class="danger">-17%</h5>
                        <h3>1100</h3>
                    </div>
                </div>

                <div class="item customers">
                    <div class="icon">
                        <span class="material-icons-sharp">person</span>
                    </div>
                    <div class="right">
                        <div class="info">
                            <h3>NEW CUSTOMERS</h3>
                            <small class="text-muted">Last 24 Hours</small>
                        </div>
                        <h5 class="success">+25%</h5>
                        <h3>3333</h3>
                    </div>
                </div>

                <div class="item add-product">
                    <div>
                        <span class="material-icons-sharp">add</span>
                        <h3>Add Product</h3>
                    </div>
                </div>

            </div>
         </div>
    </div>
    <script src="{{ url_for('static', filename='js/index.js') }}"></script>
    <script>
        // Variables para el manejo de la paginación
        const itemsPerPage = 5; // Cambia esto al número deseado de elementos por página
        const paginationList = document.getElementById('pagination-list');
        const tableBody = document.getElementById('order-table-body');
        const ordersData = []; // Aquí se almacenarán todos los datos de pedidos
        let currentPage = 1;
    
        // Función para cargar y mostrar los datos de pedidos
        function loadOrderData(pageNumber) {
            const startIndex = (pageNumber - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const ordersToDisplay = ordersData.slice(startIndex, endIndex);
    
            // Limpiar la tabla antes de cargar nuevos datos
            tableBody.innerHTML = '';
    
            // Iterar a través de los datos y crear las filas de la tabla
            ordersToDisplay.forEach(order => {
                const row = tableBody.insertRow();
                row.insertCell(0).textContent = order.table;
                row.insertCell(1).textContent = order.nameFood;
                row.insertCell(2).textContent = order.quantity;
                row.insertCell(3).textContent = order.description;
                row.insertCell(4).textContent = new Date(order.date).toLocaleDateString();
                row.insertCell(5).textContent = `$${order.total}`;
                row.insertCell(6).textContent = order.served ? 'Served' : 'Pending';
            });
        }
    
        // Llama a loadOrderData con la página inicial (por ejemplo, 1)
        loadOrderData(currentPage);
    
        // Función para crear elementos de paginación
        function createPagination(totalPages) {
            paginationList.innerHTML = '';
    
            if (currentPage > 1) {
                createPaginationItem('Previous', currentPage - 1);
            }
    
            for (let i = 1; i <= totalPages; i++) {
                createPaginationItem(i, i);
            }
    
            if (currentPage < totalPages) {
                createPaginationItem('Next', currentPage + 1);
            }
        }
    
        // Función para crear un elemento de paginación
        function createPaginationItem(text, page) {
            const li = document.createElement('li');
            li.classList.add('page-item');
            if (page === currentPage) {
                li.classList.add('active');
            }
    
            const a = document.createElement('a');
            a.href = '#';
            a.classList.add('page-link');
            a.textContent = text;
            li.appendChild(a);
    
            // Agrega un manejador de eventos para cargar los datos de la página correspondiente
            a.addEventListener('click', () => {
                if (page !== currentPage) {
                    currentPage = page;
                    loadOrderData(currentPage);
                    createPagination(Math.ceil(ordersData.length / itemsPerPage));
                }
            });
    
            paginationList.appendChild(li);
        }
    
        // Actualiza los datos de pedidos
        function updateOrderData() {
            // Hacer una solicitud para obtener los datos de pedidos
            fetch('/get_orders')
                .then(response => response.json())
                .then(data => {
                    ordersData.length = 0; // Limpia los datos existentes
                    ordersData.push(...data);
                    createPagination(Math.ceil(ordersData.length / itemsPerPage));
    
                    // Cargar la primera página de datos
                    loadOrderData(currentPage);
                })
                .catch(error => {
                    console.error('Error al obtener los datos de pedidos:', error);
                });
        }
    
        // Llama a updateOrderData una vez al cargar la página
        updateOrderData();
    
        // Actualizar los datos de pedidos cada 10 segundos (puedes ajustar el intervalo según tus necesidades)
        setInterval(updateOrderData, 10000);
    </script>
    
    
    
      
        
</body>
</html>